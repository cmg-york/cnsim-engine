<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AbstractNodeSampler.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">CNSim Engine</a> &gt; <a href="index.source.html" class="el_package">ca.yorku.cmg.cnsim.engine.sampling.interfaces</a> &gt; <span class="el_source">AbstractNodeSampler.java</span></div><h1>AbstractNodeSampler.java</h1><pre class="source lang-java linenums">package ca.yorku.cmg.cnsim.engine.sampling.interfaces;

import ca.yorku.cmg.cnsim.engine.config.Config;
import ca.yorku.cmg.cnsim.engine.sampling.Sampler;

/**
 * Abstract base class for node sampling within the CNSim engine.
 * 
 * &lt;p&gt;This class provides the common configuration and sampling logic for
 * modeling nodes in Proof-of-Work (PoW) simulations. Subclasses must
 * implement the abstract sampling methods to generate random values for
 * mining intervals, power consumption, hash power, and electricity cost
 * according to chosen distributions.&lt;/p&gt;
 *
 * &lt;p&gt;The class supports configuration via the {@link Config} object and
 * validates parameters such as means and standard deviations to ensure
 * physically meaningful values (non-negative).&lt;/p&gt;
 *
 * &lt;p&gt;Fields store statistical parameters (means and standard deviations) 
 * for different node properties, as well as the current PoW difficulty 
 * and the {@link Sampler} instance used to generate random values.&lt;/p&gt;
 *
 * @author Sotirios Liaskos
 */
public abstract class AbstractNodeSampler implements IMultiSowable {

	protected Sampler sampler;

	protected float nodeHashPowerMean;
	protected float nodeHashPowerSD;
	protected float nodeElectricPowerMean;
	protected float nodeElectricPowerSD;
	protected float nodeElectricCostMean;
	protected float nodeElectricCostSD;
	protected double currentDifficulty;


	/*
	 * 
	 * C O N S T R U C T OR S  
	 * 
	 */


	public AbstractNodeSampler() {
<span class="fc" id="L46">		super();</span>
<span class="fc" id="L47">		LoadConfig();</span>
<span class="fc" id="L48">	}</span>


	/**
	 * Constructs a new AbstractSampler object with the given parameters. Parameters define means and standard deviations of the distribution to be used.
	 *
	 * @param nodeHashPowerMean     The mean hash power of a node (hashes/second).
	 * @param nodeHashPowerSD       The standard deviation of node hash power (hashes/second).
	 * @param nodeElectricPowerMean The mean electric power consumption of a node (Watts).
	 * @param nodeElectricPowerSD   The standard deviation of node electric power consumption (Watts).
	 * @param nodeElectricCostMean  The mean electric cost of a node (real currency per kWh).
	 * @param nodeElectricCostSD    The standard deviation of node electric cost (real currency per kWh).
	 * @param difficulty            The current difficulty level ([Search Space] / [Success Space].
	 * @throws ArithmeticException if any of the provided values are less than 0.
	 */
	public AbstractNodeSampler(
			float nodeHashPowerMean, float nodeHashPowerSD,
			float nodeElectricPowerMean, float nodeElectricPowerSD,
			float nodeElectricCostMean, float nodeElectricCostSD,
			double difficulty,
			Sampler sampler) {
<span class="nc" id="L69">		super();</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">		if(nodeHashPowerMean &lt; 0)</span>
<span class="nc" id="L71">			throw new ArithmeticException(&quot;Node Hash Power Mean &lt; 0&quot;);</span>
<span class="nc" id="L72">		this.nodeHashPowerMean = nodeHashPowerMean;</span>
<span class="nc bnc" id="L73" title="All 2 branches missed.">		if(nodeHashPowerSD &lt; 0)</span>
<span class="nc" id="L74">			throw new ArithmeticException(&quot;Node Hash Power Standard Deviation &lt; 0&quot;);</span>
<span class="nc" id="L75">		this.nodeHashPowerSD = nodeHashPowerSD;</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">		if(nodeElectricPowerMean &lt; 0)</span>
<span class="nc" id="L77">			throw new ArithmeticException(&quot;Node Electric Power Mean &lt; 0&quot;);</span>
<span class="nc" id="L78">		this.nodeElectricPowerMean = nodeElectricPowerMean;</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">		if(nodeElectricPowerSD &lt; 0)</span>
<span class="nc" id="L80">			throw new ArithmeticException(&quot;Node Electric Power Standard Deviation &lt; 0&quot;);</span>
<span class="nc" id="L81">		this.nodeElectricPowerSD = nodeElectricPowerSD;</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">		if(nodeElectricCostMean &lt; 0)</span>
<span class="nc" id="L83">			throw new ArithmeticException(&quot;Node Electric Cost Mean &lt; 0&quot;);</span>
<span class="nc" id="L84">		this.nodeElectricCostMean = nodeElectricCostMean;</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">		if(nodeElectricCostSD &lt; 0)</span>
<span class="nc" id="L86">			throw new ArithmeticException(&quot;Node Electric Cost Standard Deviation &lt; 0&quot;);</span>
<span class="nc" id="L87">		this.nodeElectricCostSD = nodeElectricCostSD;</span>
<span class="nc" id="L88">		this.currentDifficulty = difficulty;</span>
<span class="nc" id="L89">		this.sampler  = sampler;</span>
<span class="nc" id="L90">	}</span>



	/* 
	 * 
	 *     S A M P L I N G   R O U T I N E S
	 *     
	 */


	/**
	 * Get a sample of a time interval it takes for a node with hash power `hashPower` to mine a block. 
	 * @param hashPower The hash power of the node (Giga-Hashes/sec)
	 * @return A time interval in milliseconds.
	 */
	public abstract long getNextMiningInterval(double hashPower);

	/**
	 * Get a sample of an nodes electric power (Watts).
	 * @return A node electric power in Watts.
	 */
	public abstract float getNextNodeElectricPower();

	/**
	 * Get a sample of a node hash power (hashes/second).
	 * @return A hashpower sample (hashes/second).
	 */
	public abstract float getNextNodeHashPower();

	/**
	 * Get a sample of electricity cost (real currency / kWh).
	 * @return A sample of electricity cost (real currency / kWh)
	 */
	public abstract float getNextNodeElectricityCost();

	/**
	 * Returns a random (or otherwise sampled) node ID (TODO: from... to...)
	 * @param nNodes The number of nodes to select from.
	 * @return The ID of a selected node.
	 */
	public abstract int getNextRandomNode(int nNodes);


	public abstract void updateSeed();





	/*
	 * 
	 * C O N F I G   O B J E C T   B A S E D   C O N F I G U R A T I O N
	 * 
	 */


	/**
	 * Load configuration using Config object.
	 */
	public void LoadConfig() {
<span class="fc" id="L151">		this.setNodeHashPowerMean(Config.getPropertyFloat(&quot;pow.hashPowerMean&quot;));</span>
<span class="fc" id="L152">		this.setNodeHashPowerSD(Config.getPropertyFloat(&quot;pow.hashPowerSD&quot;));</span>
<span class="fc" id="L153">		this.setNodeElectricPowerMean(Config.getPropertyFloat(&quot;node.electricPowerMean&quot;));</span>
<span class="fc" id="L154">		this.setNodeElectricPowerSD(Config.getPropertyFloat(&quot;node.electricPowerSD&quot;));</span>
<span class="fc" id="L155">		this.setNodeElectricCostMean(Config.getPropertyFloat(&quot;node.electricCostMean&quot;));</span>
<span class="fc" id="L156">		this.setNodeElectricCostSD(Config.getPropertyFloat(&quot;node.electricCostSD&quot;));</span>
<span class="fc" id="L157">		this.setCurrentDifficulty(Config.getPropertyDouble(&quot;pow.difficulty&quot;));</span>
<span class="fc" id="L158">	}</span>



	/*
	 * 
	 * G E T T E R S   A N D   S E T T E R S
	 * 
	 * 
	 */


	public double getCurrentDifficulty() {
<span class="nc" id="L171">		return currentDifficulty;</span>
	}

	/**
	 * Sets the difficulty parameter for PoW.
	 * @param currentDifficulty The difficulty parameter ([Search Space] / [Success Space])
	 */
	public void setCurrentDifficulty(double currentDifficulty) {
<span class="fc" id="L179">		this.currentDifficulty = currentDifficulty;</span>
<span class="fc" id="L180">	}</span>


	/**
	 * Gets the mean hash power of nodes in GH/s
	 * @return the mean hash power of nodes in GH/s
	 */
	public float getNodeHashPowerMean() {
<span class="nc" id="L188">		return nodeHashPowerMean;</span>
	}

	/**
	 * Sets the mean node hash power.
	 *
	 * @param nodeHashPowerMean The mean node hash power to be set.
	 * @throws ArithmeticException if the provided value is less than 0.
	 */
	public void setNodeHashPowerMean(float nodeHashPowerMean) {
<span class="pc bpc" id="L198" title="1 of 2 branches missed.">		if(nodeHashPowerMean &lt; 0)</span>
<span class="nc" id="L199">			throw new ArithmeticException(&quot;Node Hash Power Mean &lt; 0&quot;);</span>
<span class="fc" id="L200">		this.nodeHashPowerMean = nodeHashPowerMean;</span>
<span class="fc" id="L201">	}</span>

	/**
	 * Returns the standard deviation of node hash power.
	 *
	 * @return The standard deviation of node hash power.
	 */
	public float getNodeHashPowerSD() {
<span class="nc" id="L209">		return nodeHashPowerSD;</span>
	}

	/**
	 * Sets the standard deviation of node hash power.
	 *
	 * @param nodeHashPowerSD The standard deviation of node hash power to be set.
	 * @throws ArithmeticException if the provided value is less than 0.
	 */
	public void setNodeHashPowerSD(float nodeHashPowerSD) {
<span class="pc bpc" id="L219" title="1 of 2 branches missed.">		if(nodeHashPowerSD &lt; 0)</span>
<span class="nc" id="L220">			throw new ArithmeticException(&quot;Node Hash Power Standard Deviation &lt; 0&quot;);</span>
<span class="fc" id="L221">		this.nodeHashPowerSD = nodeHashPowerSD;</span>
<span class="fc" id="L222">	}</span>


	/**
	 * Returns the mean node electric power.
	 *
	 * @return The mean node electric power.
	 */
	public float getNodeElectricPowerMean() {
<span class="nc" id="L231">		return nodeElectricPowerMean;</span>
	}


	/**
	 * Sets the mean node electric power.
	 *
	 * @param nodeElectricPowerMean The mean node electric power to be set.
	 * @throws ArithmeticException if the provided value is less than 0.
	 */
	public void setNodeElectricPowerMean(float nodeElectricPowerMean) {
<span class="pc bpc" id="L242" title="1 of 2 branches missed.">		if(nodeElectricPowerMean &lt; 0)</span>
<span class="nc" id="L243">			throw new ArithmeticException(&quot;Node Electric Power Mean &lt; 0&quot;);</span>
<span class="fc" id="L244">		this.nodeElectricPowerMean = nodeElectricPowerMean;</span>
<span class="fc" id="L245">	}</span>

	/**
	 * Returns the standard deviation of node electric power.
	 *
	 * @return The standard deviation of node electric power.
	 */
	public float getNodeElectricPowerSD() {
<span class="nc" id="L253">		return nodeElectricPowerSD;</span>
	}

	/**
	 * Sets the standard deviation of node electric power.
	 *
	 * @param nodeElectricPowerSD The standard deviation of node electric power to be set.
	 * @throws ArithmeticException if the provided value is less than 0.
	 */
	public void setNodeElectricPowerSD(float nodeElectricPowerSD) {
<span class="pc bpc" id="L263" title="1 of 2 branches missed.">		if(nodeElectricPowerSD &lt; 0)</span>
<span class="nc" id="L264">			throw new ArithmeticException(&quot;Node Electric Power Standard Deviation &lt; 0&quot;);</span>
<span class="fc" id="L265">		this.nodeElectricPowerSD = nodeElectricPowerSD; </span>
<span class="fc" id="L266">	}</span>

	/**
	 * Returns the mean node electric cost.
	 *
	 * @return The mean node electric cost.
	 */
	public float getNodeElectricCostMean() {
<span class="nc" id="L274">		return nodeElectricCostMean;</span>
	}

	/**
	 * Sets the mean node electric cost.
	 *
	 * @param nodeElectricCostMean The mean node electric cost to be set.
	 * @throws ArithmeticException if the provided value is less than 0.
	 */
	public void setNodeElectricCostMean(float nodeElectricCostMean) {
<span class="pc bpc" id="L284" title="1 of 2 branches missed.">		if(nodeElectricCostMean &lt; 0)</span>
<span class="nc" id="L285">			throw new ArithmeticException(&quot;Node Electric Cost Mean &lt; 0&quot;);</span>
<span class="fc" id="L286">		this.nodeElectricCostMean = nodeElectricCostMean;</span>
<span class="fc" id="L287">	}</span>

	/**
	 * Returns the standard deviation of node electric cost.
	 *
	 * @return The standard deviation of node electric cost.
	 */
	public float getNodeElectricCostSD() {
<span class="nc" id="L295">		return nodeElectricCostSD;</span>
	}

	/**
	 * Sets the standard deviation of node electric cost.
	 *
	 * @param nodeElectricCostSD The standard deviation of node electric cost to be set.
	 * @throws ArithmeticException if the provided value is less than 0.
	 */
	public void setNodeElectricCostSD(float nodeElectricCostSD) {
<span class="pc bpc" id="L305" title="1 of 2 branches missed.">		if(nodeElectricCostSD &lt; 0)</span>
<span class="nc" id="L306">			throw new ArithmeticException(&quot;Node Electric Cost Standard Deviation &lt; 0&quot;);</span>
<span class="fc" id="L307">		this.nodeElectricCostSD = nodeElectricCostSD;</span>
<span class="fc" id="L308">	}</span>


	public Sampler getSampler() {
<span class="nc" id="L312">		return sampler;</span>
	}

	public void setSampler(Sampler sampler) {
<span class="nc" id="L316">		this.sampler = sampler;</span>
<span class="nc" id="L317">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>