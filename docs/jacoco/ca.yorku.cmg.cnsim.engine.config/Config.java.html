<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Config.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">CNSim Engine</a> &gt; <a href="index.source.html" class="el_package">ca.yorku.cmg.cnsim.engine.config</a> &gt; <span class="el_source">Config.java</span></div><h1>Config.java</h1><pre class="source lang-java linenums">package ca.yorku.cmg.cnsim.engine.config;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.util.Arrays;
import java.util.Properties;

import ca.yorku.cmg.cnsim.engine.exceptions.ConfigurationException;

<span class="fc" id="L13">public class Config {</span>
<span class="fc" id="L14">    static Properties prop = new Properties();</span>
<span class="fc" id="L15">    static boolean initialized = false;</span>
<span class="fc" id="L16">    static String configLabel = &quot;&quot;;</span>
    
    public static void init(String propFileName) throws FileNotFoundException {
    	
<span class="fc" id="L20">        File file = new File(propFileName);</span>
<span class="pc bpc" id="L21" title="1 of 2 branches missed.">        if (!file.exists()) {</span>
<span class="nc" id="L22">            throw new FileNotFoundException(propFileName + &quot; not found&quot;);</span>
        }

<span class="fc" id="L25">        configLabel = file.getName();</span>
<span class="fc" id="L26">        int dotIndex = configLabel.lastIndexOf('.');</span>
<span class="pc bpc" id="L27" title="1 of 2 branches missed.">        if (dotIndex &gt; 0) {</span>
<span class="fc" id="L28">			configLabel = configLabel.substring(0, dotIndex);</span>
		}
        
<span class="fc" id="L31">        try (InputStream in = new FileInputStream(file)) {</span>
<span class="fc" id="L32">            prop.load(in);</span>
<span class="fc" id="L33">            initialized = true;</span>
<span class="nc" id="L34">        } catch (IOException e) {</span>
<span class="nc" id="L35">            e.printStackTrace();</span>
<span class="nc" id="L36">            System.exit(-1);</span>
<span class="fc" id="L37">        }</span>
<span class="fc" id="L38">    }</span>
    
    /**
    public static void chk(String propertyKey) throws Exception {
    	if (!initialized) {
    		throw new Exception(&quot;Error: configuration file uninitialized.&quot;);
    	} else if (prop.getProperty(propertyKey) == null) {
    		throw new Exception(&quot;Error reading configuration file: property '&quot; + propertyKey + &quot;' does not exist.&quot;);
    	}
    } */

    public static void check(String propertyKey) {
<span class="pc bpc" id="L50" title="1 of 2 branches missed.">    	if (!initialized) {</span>
<span class="nc" id="L51">    		throw new ConfigurationException(&quot;Error: configuration file uninitialized.&quot;);</span>
<span class="pc bpc" id="L52" title="1 of 2 branches missed.">    	} else if (!prop.containsKey(propertyKey)) {</span>
<span class="nc" id="L53">    		throw new ConfigurationException(&quot;Error reading configuration file: property '&quot; + propertyKey + &quot;' does not exist.&quot;);</span>
    	}

<span class="fc" id="L56">    }</span>
    

    /*
     * 
     * PROPERTY READING
     *  
     */

    
    public static String getProperty(String propertyKey) {
<span class="fc" id="L67">    	check(propertyKey);</span>
<span class="fc" id="L68">    	return prop.getProperty(propertyKey);</span>
    }
    
    
    public static int getPropertyInt(String propertyKey) {
    	int l; 
<span class="fc" id="L74">    	String val = getProperty(propertyKey);</span>
    	try {
<span class="fc" id="L76">    		l =  Integer.parseInt(val);</span>
<span class="nc" id="L77">    	} catch (NumberFormatException e) {</span>
<span class="nc" id="L78">    		throw new ConfigurationException(&quot;Error reading configuration key: '&quot; + propertyKey + &quot;' as integer&quot;,e);</span>
<span class="fc" id="L79">    	}</span>
<span class="fc" id="L80">        return l;</span>
     }
    
    public static long getPropertyLong(String propertyKey) {
    	long l; 
<span class="fc" id="L85">    	String val = getProperty(propertyKey);</span>
    	try {
<span class="fc" id="L87">    		l =  Long.parseLong(val);</span>
<span class="nc" id="L88">    	} catch (NumberFormatException e) {</span>
<span class="nc" id="L89">    		throw new ConfigurationException(&quot;Error reading configuration key: '&quot; + propertyKey + &quot;' as long&quot;,e);</span>
<span class="fc" id="L90">    	}</span>
<span class="fc" id="L91">        return l;</span>
     }
    
    public static Float getPropertyFloat(String propertyKey) {
    	float l; 
<span class="fc" id="L96">    	String val = getProperty(propertyKey);</span>
    	try {
<span class="fc" id="L98">    		l =  Float.parseFloat(val);</span>
<span class="nc" id="L99">    	} catch (NumberFormatException e) {</span>
<span class="nc" id="L100">    		throw new ConfigurationException(&quot;Error reading configuration key: '&quot; + propertyKey + &quot;' as float&quot;,e);</span>
<span class="fc" id="L101">    	}</span>
<span class="fc" id="L102">        return l;</span>
     }
 

    public static Double getPropertyDouble(String propertyKey) {
    	double l;
<span class="fc" id="L108">    	String val = getProperty(propertyKey);</span>
    	try {
<span class="fc" id="L110">    		l =  Double.parseDouble(val);</span>
<span class="nc" id="L111">    	} catch (NumberFormatException e) {</span>
<span class="nc" id="L112">    		throw new ConfigurationException(&quot;Error reading configuration key: '&quot; + propertyKey + &quot;' as float&quot;,e);</span>
<span class="fc" id="L113">    	}</span>
<span class="fc" id="L114">        return l;</span>
     }
    
	public static boolean getPropertyBoolean(String propertyKey) {

<span class="fc" id="L119">    	String val = getProperty(propertyKey);</span>
    	
<span class="pc bpc" id="L121" title="1 of 2 branches missed.">        if (val == null) {</span>
<span class="nc" id="L122">            throw new ConfigurationException(&quot;Missing required boolean property: &quot; + propertyKey);</span>
        }
        
<span class="fc" id="L125">        val = val.trim();</span>

<span class="pc bpc" id="L127" title="1 of 3 branches missed.">        switch (val.toUpperCase()) {</span>
            case &quot;TRUE&quot;:
            case &quot;T&quot;:
<span class="fc" id="L130">                return true;</span>
            case &quot;FALSE&quot;:
            case &quot;F&quot;:
<span class="fc" id="L133">                return false;</span>
            default:
<span class="nc" id="L135">                throw new ConfigurationException(</span>
                    &quot;Invalid boolean value for property '&quot; + propertyKey + &quot;': '&quot; + val + &quot;'. &quot; +
                    &quot;Expected true/false or T/F (case-insensitive).&quot;
                );
        }
	}
	
	public static String getPropertyString(String propertyKey) {
<span class="fc" id="L143">		return(prop.getProperty(propertyKey,null));</span>
	}

	
    /**
     * Takes a string of the form &quot;{ID1, ID2, ...}&quot; and returns a long array with the IDs.   
     * @param input A string of the form &quot;{ID1, ID2, ...}&quot;, where ID1, ID2 are transaction IDs.
     * @return A long array of ID1, ID2, ... .  If input string is empty (&quot;&quot;), or &quot;{}&quot;, or null, 
     * return value is null.
     * @throws IllegalArgumentException if input string is malformed i.e., 
     *    (a) missing &quot;{&quot; or &quot;}, 
     *    (b) any IDi is greater than workload.numTransactions TODO
     *    (c) any IDi is not numeric
     */
    public static long[] parseStringToArray(String input) {
        // Remove the curly braces and split the string by commas
    	
<span class="fc bfc" id="L160" title="All 2 branches covered.">    	if (input.equals(&quot;&quot;)) return (new long[0]);</span>
<span class="fc bfc" id="L161" title="All 2 branches covered.">    	if (input.equals(&quot;{}&quot;)) return (new long[0]);</span>
    	
<span class="fc bfc" id="L163" title="All 2 branches covered.">    	if (!String.valueOf(input.charAt(input.length()-1)).equals(&quot;}&quot;)) throw new IllegalArgumentException(&quot;Error in configuration file, line with &quot; + input + &quot;: missing closing bracket.&quot;);</span>
<span class="fc bfc" id="L164" title="All 2 branches covered.">    	if (!String.valueOf(input.charAt(0)).equals(&quot;{&quot;)) throw new IllegalArgumentException(&quot;Error in configuration file, line with &quot; + input + &quot;: missing opening bracket.&quot;);</span>
    	
    	
<span class="fc" id="L167">    	String trimmed = input.substring(1, input.length() - 1);</span>
    	
<span class="fc" id="L169">        String[] parts = trimmed.split(&quot;,&quot;);</span>

<span class="fc bfc" id="L171" title="All 2 branches covered.">        for (int i = 0; i &lt; parts.length; i++) {</span>
<span class="fc" id="L172">            String element = parts[i];</span>

<span class="pc bpc" id="L174" title="2 of 4 branches missed.">            if (element == null || element.isEmpty()) {</span>
<span class="nc" id="L175">                throw new IllegalArgumentException(&quot;Element at index &quot; + i + &quot; is null or empty.&quot;);</span>
            }

            try {
<span class="fc" id="L179">                Integer.parseInt(element.trim()); // Attempt to parse the string as an integer</span>
<span class="fc" id="L180">            } catch (NumberFormatException e) {</span>
<span class="fc" id="L181">                throw new IllegalArgumentException(&quot;Invalid integer found at index &quot; + i + &quot;: '&quot; + element + &quot;'.&quot;);</span>
<span class="fc" id="L182">            }</span>
        }
        
        // Create an array to store the integers
<span class="fc" id="L186">        long[] result = new long[parts.length];</span>
        
        // Parse each part to an integer and store it in the array
<span class="fc bfc" id="L189" title="All 2 branches covered.">        for (int i = 0; i &lt; parts.length; i++) {</span>
<span class="fc" id="L190">            result[i] = Long.parseLong(parts[i].trim());</span>
        }

<span class="fc" id="L193">        return result;</span>
    }
	   
    
    public static boolean[] parseStringToBoolean(String input) {
        // Remove the curly braces and split the string by commas
<span class="nc" id="L199">        String trimmed = input.substring(1, input.length() - 1);</span>
<span class="nc" id="L200">        String[] parts = trimmed.split(&quot;,&quot;);</span>

        // Create an array to store the booleans
<span class="nc" id="L203">        boolean[] result = new boolean[parts.length];</span>

        // Parse each part to a boolean and store it in the array
<span class="nc bnc" id="L206" title="All 2 branches missed.">        for (int i = 0; i &lt; parts.length; i++) {</span>
<span class="nc" id="L207">            result[i] = Boolean.parseBoolean(parts[i].trim());</span>
        }

<span class="nc" id="L210">        return result;</span>
    }
    
    
    public static int[] parseStringToIntArray(String input) {
<span class="nc" id="L215">    	return (Arrays.stream(parseStringToArray(input)).</span>
<span class="nc" id="L216">    			mapToInt(i -&gt; (int) i).toArray());</span>
    }
    

    public static void printProperties() {
<span class="nc bnc" id="L221" title="All 2 branches missed.">        for (Object key: prop.keySet()) {</span>
<span class="nc" id="L222">            System.out.println(key + &quot;: &quot; + prop.getProperty(key.toString()));</span>
<span class="nc" id="L223">        }</span>
<span class="nc" id="L224">    }</span>
    
    public static String printPropertiesToString() {
<span class="nc" id="L227">    	String s = &quot;&quot;;</span>
<span class="nc bnc" id="L228" title="All 2 branches missed.">        for (Object key: prop.keySet()) {</span>
<span class="nc" id="L229">            s = s + key + &quot;,&quot; + prop.getProperty(key.toString()) + System.lineSeparator();</span>
<span class="nc" id="L230">        }</span>
<span class="nc" id="L231">        return(s);</span>
    }

	public static boolean hasProperty(String s) {
<span class="fc" id="L235">		return prop.containsKey(s);</span>
	}
	
	public static String getConfigLabel() {
<span class="fc" id="L239">		return configLabel;</span>
	}
	
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>